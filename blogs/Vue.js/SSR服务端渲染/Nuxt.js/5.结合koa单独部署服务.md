# 结合koa单独部署服务

2018-04-20 00:47:07

## 准备工作
既然是nuxt结合koa，那么当然需要nuxt和koa模块了，通过
` > npm install nuxt koa --save`
安装上koa模块，搞定

## 搭建nuxt环境
搭建nuxt环境，为了简单我们直接放一个helloworld页面，参考本章节第一篇<a target="_blank" href="https://710241969.github.io/#/Vue.js/SSR服务端渲染/Nuxt.js/1.从HelloWorld开始">从HelloWorld开始</a>
直接拿来用就可以了
然后在项目根路径下新建`nuxt.config.js`，本例子，直接是个空的就可以
```javascript
module.exports = {
}
```

## 编写koa
在项目根路径下新建`server.js`
```javascript
  const Koa = require('koa')
  const { Nuxt, Builder } = require('nuxt')

  const HOST = process.env.HOST || 'localhost'
  const PORT = process.env.PORT || 8087
  const ENV = process.env.NODE_ENV

  const NUXT_CONFIG = require('./nuxt.config.js') //引入nuxt配置
  NUXT_CONFIG.dev = ENV === 'production' // 这一步不能少，否则页面将不会显示

  const NUXT = new Nuxt(NUXT_CONFIG) // 创建nuxt实例
  const APP = new Koa() //创建koa实例

  async function start() {
      
      // 若dev为true，即不是生产环境，就构建一遍nuxt
      if (NUXT_CONFIG.dev) {
          await new Builder(NUXT).build()
      }

      // 使用nuxt的render，渲染页面中间件
      APP.use(async (ctx, next) => {
          await next()
          ctx.status = 200 // koa defaults to 404 when it sees that status is unset
          return new Promise((resolve, reject) => {
              ctx.res.on('close', resolve)
              ctx.res.on('finish', resolve)
              NUXT.render(ctx.req, ctx.res, promise => {
                  // nuxt.render passes a rejected promise into callback on error.
                  promise.then(resolve).catch(reject)
              })
          })
      })

      APP.listen(PORT, HOST)
      console.log('Server listening on ' + HOST + ':' + PORT) // eslint-disable-line no-console
  }

  start()
```
此时我们就可以通过`node server.js`运行了
![](
  data:image/png;base64,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
)

## 注意！
注意，上面直接通过`node server.js`运行的话，结果一定是dev环境下运行nuxt，因为没有指定运行环境。
可以通过注释上面代码的
**第6行**
```javascript
  // const ENV = process.env.NODE_ENV
```
**第9行**
```javascript
  // NUXT_CONFIG.dev = ENV !== 'production'
```
在`package.json`中加入
```javascript
  "scripts": {
    "dev": "nuxt",
    "build": "nuxt build",
    "start": "nuxt start"
  }
```
然后，通过在`nuxt.config.js`中指定
```javascript
  module.exports = {
      dev: true // or false
  }
```
**！！！若指定dev为false！！！**，则必须先通过`npm run build`构建生产环境版本（即打包出来的`.nuxt`目录中存在`dist`目录），这和要运行`npm run start`必须先build是一个道理

## 代码地址
<a target="_blank" href="https://github.com/710241969/my-nuxt-example/tree/master/nuxt-koa">代码地址</a>